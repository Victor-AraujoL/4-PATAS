<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Associação 4 Patas - Cadastro de Pets</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/cadastro_pet.css"/>
</head>
<body>
    <button class="close-btn" onclick="window.location.href='index.html';">
        <i class="fas fa-times"></i>
    </button>

    <div class="container py-4">
        <div class="row justify-content-center">
            <div class="col-12">
                <div class="main-card mx-auto">
                    <div class="header">
                        <i class="fas fa-paw fa-2x mb-2"></i>
                        <h1>Cadastro de Pet</h1>
                        <p class="mb-0">Preencha as informações do seu pet</p>
                    </div>

                    <div class="progress-section">
                        <div class="step-indicator">
                            <div class="step active" id="step-1">1</div>
                            <div class="step-line" id="line-1"></div>
                            <div class="step" id="step-2">2</div>
                        </div>
                        <div class="text-center mt-2">
                            <small id="step-text">Dados do Pet</small>
                        </div>
                    </div>
                    <div id="message-area"></div>

                    <div class="form-content">
                        <form id="petForm">
                            <div class="form-step active" id="form-step-1">
                                <h5 class="mb-3">
                                    <i class="fas fa-paw text-primary me-2"></i>
                                    Informações do Pet
                                </h5>

                                <div class="photo-upload">
                                    <div class="photo-preview" id="photo-preview" onclick="document.getElementById('photo-input').click()">
                                        <div id="photo-placeholder">
                                            <i class="fas fa-camera fa-2x text-muted mb-2"></i>
                                            <div>Adicionar foto</div>
                                        </div>
                                        <img id="photo-img" alt="Preview">
                                    </div>
                                    <input type="file" id="photo-input" accept="image/*" style="display: none;">
                                    <small class="text-muted">Clique para adicionar uma foto</small>
                                </div>

                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label required">Nome do Pet</label>
                                        <input type="text" id="pet-name" class="form-control" placeholder="Nome do pet" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label required">Espécie</label>
                                        <select id="pet-species" class="form-select" required>
                                            <option value="">Selecione</option>
                                            <option value="cachorro">Cachorro</option>
                                            <option value="gato">Gato</option>
                                            <option value="ave">Ave</option>
                                            <option value="reptil">Réptil</option>
                                            <option value="roedor">Roedor</option>
                                            <option value="outro">Outro</option>
                                        </select>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Raça</label>
                                        <input type="text" id="pet-breed" class="form-control" placeholder="Raça">
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Idade</label>
                                        <input type="text" id="pet-age" class="form-control" placeholder="Ex: 2 anos">
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Peso (kg)</label>
                                        <input type="number" id="pet-weight" class="form-control" placeholder="0.0" step="0.1">
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Cor</label>
                                        <input type="text" id="pet-color" class="form-control" placeholder="Cor predominante">
                                    </div>

                                    <div class="col-12">
                                        <label class="form-label">Sexo</label>
                                        <div class="radio-group">
                                            <label class="radio-option selected" for="male">
                                                <input type="radio" name="petGender" id="male" value="macho" checked>
                                                Macho
                                            </label>
                                            <label class="radio-option" for="female">
                                                <input type="radio" name="petGender" id="female" value="femea">
                                                Fêmea
                                            </label>
                                        </div>
                                    </div>

                                    <div class="col-12">
                                        <label class="form-label">Observações</label>
                                        <textarea id="pet-notes" class="form-control" rows="3" placeholder="Características, comportamento, cuidados especiais..."></textarea>
                                    </div>
                                </div>

                                <div class="button-group">
                                    <div></div>
                                    <button type="button" class="btn-custom btn-primary-custom" onclick="nextStep()">
                                        Próximo <i class="fas fa-arrow-right ms-1"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="form-step" id="form-step-2">
                                <h5 class="mb-3">
                                    <i class="fas fa-user text-primary me-2"></i>
                                    Dados do Tutor
                                </h5>

                                <div class="row g-3">
                                    <div class="col-md-8">
                                        <label class="form-label required">Nome Completo</label>
                                        <input type="text" id="tutor-name" class="form-control" placeholder="Nome completo" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-4">
                                        <label class="form-label required">CPF</label>
                                        <input type="text" id="tutor-cpf" class="form-control" placeholder="000.000.000-00" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label required">Telefone</label>
                                        <input type="tel" id="tutor-phone" class="form-control" placeholder="(00) 00000-0000" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">E-mail</label>
                                        <input type="email" id="tutor-email" class="form-control" placeholder="email@exemplo.com">
                                    </div>

                                    <div class="col-md-3">
                                        <label class="form-label required">CEP</label>
                                        <input type="text" id="tutor-cep" class="form-control" placeholder="00000-000" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label required">Endereço</label>
                                        <input type="text" id="tutor-address" class="form-control" placeholder="Rua, Avenida..." required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-3">
                                        <label class="form-label required">Número</label>
                                        <input type="text" id="tutor-number" class="form-control" placeholder="Nº" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label required">Cidade</label>
                                        <input type="text" id="tutor-city" class="form-control" placeholder="Cidade" required>
                                        <div class="invalid-feedback"></div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label required">Estado</label>
                                        <select id="tutor-state" class="form-select" required>
                                            <option value="">Selecione</option>
                                            <option value="AC">Acre</option>
                                            <option value="AL">Alagoas</option>
                                            <option value="AM">Amazonas</option>
                                            <option value="BA">Bahia</option>
                                            <option value="CE">Ceará</option>
                                            <option value="ES">Espírito Santo</option>
                                            <option value="GO">Goiás</option>
                                            <option value="MG">Minas Gerais</option>
                                            <option value="MT">Mato Grosso</option>
                                            <option value="MS">Mato Grosso do Sul</option>
                                            <option value="PA">Pará</option>
                                            <option value="PR">Paraná</option>
                                            <option value="RJ">Rio de Janeiro</option>
                                            <option value="RN">Rio Grande do Norte</option>
                                            <option value="RS">Rio Grande do Sul</option>
                                            <option value="SC">Santa Catarina</option>
                                            <option value="SP">São Paulo</option>
                                            <option value="Other">Outro</option>
                                        </select>
                                        <div class="invalid-feedback"></div>
                                    </div>
                                </div>

                                <div class="button-group">
                                    <button type="button" class="btn-custom btn-secondary-custom" onclick="previousStep()">
                                        <i class="fas fa-arrow-left me-1"></i> Voltar
                                    </button>
                                    <div>
                                        <button type="button" class="btn-custom btn-outline-custom me-2" onclick="resetForm()">
                                            <i class="fas fa-undo me-1"></i> Limpar
                                        </button>
                                        <button type="submit" class="btn-custom btn-primary-custom" id="submit-btn">
                                            <i class="fas fa-save me-1"></i> Cadastrar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let currentStep = 1;
        function showMessage(message, type) {
            const messageArea = document.getElementById('message-area');
            messageArea.innerHTML = `
                <div class="alert-custom alert-${type}">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'} me-2"></i>
                    ${message}
                </div>
            `;
            setTimeout(() => messageArea.innerHTML = '', 5000);
        }

        function nextStep() {
            if (validateStep1()) {
                currentStep = 2;
                updateStep();
                showMessage('Próxima etapa: dados do tutor', 'success');
            }
        }

        function previousStep() {
            currentStep = 1;
            updateStep();
        }

        function updateStep() {
            document.querySelectorAll('.form-step').forEach(step => step.classList.remove('active'));
            document.getElementById(`form-step-${currentStep}`).classList.add('active');
            
            if (currentStep === 1) {
                document.getElementById('step-1').classList.add('active');
                document.getElementById('step-1').classList.remove('completed');
                document.getElementById('step-2').classList.remove('active');
                document.getElementById('line-1').classList.remove('completed');
                document.getElementById('step-text').textContent = 'Dados do Pet';
            } else {
                document.getElementById('step-1').classList.remove('active');
                document.getElementById('step-1').classList.add('completed');
                document.getElementById('step-2').classList.add('active');
                document.getElementById('line-1').classList.add('completed');
                document.getElementById('step-text').textContent = 'Dados do Tutor';
            }
        }

        function validateStep1() {
            const name = document.getElementById('pet-name');
            const species = document.getElementById('pet-species');
            let isValid = true;

            if (!name.value.trim()) {
                setInvalid(name, 'Nome é obrigatório');
                isValid = false;
            } else {
                setValid(name);
            }

            if (!species.value) {
                setInvalid(species, 'Espécie é obrigatória');
                isValid = false;
            } else {
                setValid(species);
            }

            return isValid;
        }

        function validateStep2() {
            const fields = [
                { id: 'tutor-name', message: 'Nome é obrigatório' },
                { id: 'tutor-cpf', message: 'CPF é obrigatório' },
                { id: 'tutor-phone', message: 'Telefone é obrigatório' },
                { id: 'tutor-cep', message: 'CEP é obrigatório' },
                { id: 'tutor-address', message: 'Endereço é obrigatório' },
                { id: 'tutor-number', message: 'Número é obrigatório' },
                { id: 'tutor-city', message: 'Cidade é obrigatória' },
                { id: 'tutor-state', message: 'Estado é obrigatório' }
            ];

            let isValid = true;
            fields.forEach(field => {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    setInvalid(element, field.message);
                    isValid = false;
                } else {
                    setValid(element);
                }
            });

            return isValid;
        }

        function setValid(field) {
            field.classList.remove('is-invalid');
            field.classList.add('is-valid');
            const feedback = field.nextElementSibling;
            if (feedback && feedback.classList.contains('invalid-feedback')) {
                feedback.textContent = '';
            }
        }

        function setInvalid(field, message) {
            field.classList.remove('is-valid');
            field.classList.add('is-invalid');
            const feedback = field.nextElementSibling;
            if (feedback && feedback.classList.contains('invalid-feedback')) {
                feedback.textContent = message;
            }
        }

        document.getElementById('photo-input').addEventListener('change', function(e) {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('photo-img');
                    const placeholder = document.getElementById('photo-placeholder');
                    const preview = document.getElementById('photo-preview');
                    
                    img.src = event.target.result;
                    img.style.display = 'block';
                    placeholder.style.display = 'none';
                    preview.classList.add('has-image');
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        });

        document.getElementById('tutor-phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 10) {
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, '($1) $2-$3');
            } else {
                value = value.replace(/^(\d{2})(\d{5})(\d{0,4}).*/, '($1) $2-$3');
            }
            e.target.value = value;
        });

        document.getElementById('tutor-cpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{3})(\d{3})(\d{3})(\d{0,2}).*/, '$1.$2.$3-$4');
            e.target.value = value;
        });

        document.getElementById('tutor-cep').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{5})(\d{0,3}).*/, '$1-$2');
            e.target.value = value;
        });

        document.getElementById('tutor-cep').addEventListener('blur', function() {
            const cep = this.value.replace(/\D/g, '');
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.erro) {
                            document.getElementById('tutor-address').value = data.logradouro;
                            document.getElementById('tutor-city').value = data.localidade;
                            document.getElementById('tutor-state').value = data.uf;
                        }
                    });
            }
        });

        document.querySelectorAll('input[name="petGender"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.querySelectorAll('.radio-option').forEach(option => {
                    option.classList.remove('selected');
                });
                this.parentElement.classList.add('selected');
            });
        });

        document.getElementById('petForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateStep2()) {
                showMessage('Por favor, corrija os erros antes de continuar', 'error');
                return;
            }

            const submitBtn = document.getElementById('submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i> Cadastrando...';
            submitBtn.disabled = true;

            setTimeout(() => {
                const petId = 'PET' + Math.floor(10000 + Math.random() * 90000);
                showMessage(`Pet cadastrado com sucesso! ID: ${petId}`, 'success');
                submitBtn.innerHTML = '<i class="fas fa-save me-1"></i> Cadastrar';
                submitBtn.disabled = false;
            }, 2000);
        });

        function resetForm() {
            if (confirm('Limpar todos os dados?')) {
                document.getElementById('petForm').reset();
                document.getElementById('photo-img').style.display = 'none';
                document.getElementById('photo-placeholder').style.display = 'block';
                document.getElementById('photo-preview').classList.remove('has-image');
                document.querySelectorAll('.form-control, .form-select').forEach(field => {
                    field.classList.remove('is-valid', 'is-invalid');
                });
                document.querySelector('input[name="petGender"][value="macho"]').parentElement.classList.add('selected');
                currentStep = 1;
                updateStep();
                showMessage('Formulário limpo!', 'success');
            }
        }
    </script>
</body>
</html>